# LLM Clustering –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç-—Ü–µ–Ω—Ç—Ä–∞

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ [README.md](../README.md) –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞. –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞.

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –∫–æ–Ω—Ç–∞–∫—Ç-—Ü–µ–Ω—Ç—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM-–º–æ–¥–µ–ª–µ–π.

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- üöÄ –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞
- üîå –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö LLM-–º–æ–¥–µ–ª–µ–π
- üìä –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- üîÑ –î–æ—Ä–∞–∑–º–µ—Ç–∫–∞ —Å —É—á–µ—Ç–æ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- üéØ –ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
- üì¶ –õ–µ–≥–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –ª—é–±–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
llm_clustering/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ llm_clustering/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ config/          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ       ‚îú‚îÄ‚îÄ llm/             # LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (OpenAI, Anthropic)
‚îÇ       ‚îú‚îÄ‚îÄ clustering/      # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ core/            # –Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ utils/           # –£—Ç–∏–ª–∏—Ç—ã (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç.–¥.)
‚îú‚îÄ‚îÄ tests/                   # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ ai_doc/                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ ai_experiments/          # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ —Ç–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ ai_data/                 # –î–∞–Ω–Ω—ã–µ, –ª–æ–≥–∏, –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ö–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ editable mode
pip install -e /path/to/llm_clustering

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É
python -c "import llm_clustering; print(llm_clustering.__version__)"
```

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt
# –∏–ª–∏ —Å dev-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
pip install -e ".[dev]"
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ API –∫–ª—é—á–∏:

```bash
cp env.example .env
```

**–í–∞–∂–Ω–æ**: –ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **Ollama** —Å –º–æ–¥–µ–ª—å—é **`qwen3:30b-a3b`** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `ollama serve` –∑–∞–ø—É—â–µ–Ω –∏ –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ (`ollama pull qwen3:30b-a3b`).

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞

```python
from llm_clustering import ClusteringPipeline
import pandas as pd

# –°–æ–∑–¥–∞—Ç—å pipeline
pipeline = ClusteringPipeline()

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
df = pd.DataFrame({
    "text": ["–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏", "–ó–∞–±—ã–ª –ø–∞—Ä–æ–ª—å", "–¢–æ–≤–∞—Ä –Ω–µ –ø—Ä–∏—à–µ–ª"]
})

# –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞—Ç—å
result = pipeline.fit(df, text_column="text")

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
print(f"Coverage: {result.coverage:.1f}%")
print(f"Clusters: {len(result.clusters)}")

for cluster in result.clusters:
    print(f"  - {cluster.name}: {cluster.count} requests")
```

### –° –∫–∞—Å—Ç–æ–º–Ω–æ–π LLM

```python
from llm_clustering import ClusteringPipeline, BaseLLMProvider

class MyLLM(BaseLLMProvider):
    def chat_completion(self, messages, temperature=None, max_tokens=None):
        # –í–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
        return json_response
    
    # –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–æ–∂–Ω–æ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å
    def embed(self, texts): raise NotImplementedError()
    def cluster(self, texts, num_clusters=None): raise NotImplementedError()
    def describe_cluster(self, texts): raise NotImplementedError()

pipeline = ClusteringPipeline(llm_provider=MyLLM())
result = pipeline.fit(df)
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CLI

```bash
# –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–∞
llm-clustering --input data.csv --text-column text --limit 100

# –°–ø—Ä–∞–≤–∫–∞
llm-clustering --help
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ API](library_usage.md)** - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
- **[–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](quickstart.md)** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ø–µ—Ä–≤—ã–µ —à–∞–≥–∏
- **[–ü—Ä–∏–º–µ—Ä—ã](../examples.py)** - –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
- **[–ò–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏](library_api_changes.md)** - —á—Ç–æ –Ω–æ–≤–æ–≥–æ

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **ClusteringPipeline**: –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
- **BaseLLMProvider**: –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ LLM
- **ClusterRegistry**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏
- **Settings**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

```python
for partial in pipeline.fit_partial(df, batch_size=50):
    print(f"Batch {partial.batch_number}: {partial.processed_rows}/{partial.total_rows}")
```

### 2. –î–æ—Ä–∞–∑–º–µ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```python
result1 = pipeline.fit(df_part1)
result2 = pipeline.refit(df_part2, previous_assignments=result1.assignments)
```

### 3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

```python
pipeline.save_clusters(Path("clusters.json"))
pipeline.load_clusters(Path("clusters.json"))
```

### 4. –ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç

```python
context = "–†–∞–∑–º–µ—Ç–∫–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –±–æ—Ç–∞. –†–∞–∑–¥–µ–ª—è–π –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏."
pipeline = ClusteringPipeline(business_context=context)
```

